<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<div id="test" style="width:1px;height:17px;background:#0f0;">0%</div>
		<input type="button" value="Run" id="run"/>
		<input type="button" value="stop" id="stop"/>
		
		<script>
			
			window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
			var start = null;
			var ele = document.getElementById("test");
			var progress = 0;
			var isrun = false;
			
			function step(timestamp) {
			    
			    if (progress < 100) {
			    	progress += 0.5;
			    	ele.style.width = progress + "%";
			    	ele.innerHTML=progress + "%";
			        rf = requestAnimationFrame(step);
			    }
			}

			document.getElementById("run").addEventListener("click", function() {
				
				isrun = true;
				
				console.log(isrun);
				
			    ele.style.width = "1px";
			    progress = 0;
			    rf = requestAnimationFrame(step);
			    
			}, false);
			
			
			document.getElementById("stop").addEventListener("click", function() {
				
				console.log(isrun);
				
				if(isrun){
					cancelAnimationFrame(rf);
					isrun = false;
				}else{
					 rf = requestAnimationFrame(step);
					 isrun = true;
				}
				
			}, false);
		</script>
	</body>
</html>
